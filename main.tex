% -*- coding: utf-8 -*-
%%
%%
%%
%%
%%
%%
%%  本模板可以使用以下两种方式编译:
%%
%%     1. PDFLaTeX
%%
%%     2. XeLaTeX [推荐]
%%
%%  注意：
%%    1. 在改变编译方式前应先删除 *.toc 和 *.aux 文件，
%%       因为不同编译方式产生的辅助文件格式可能并不相同。
%%
%%
\documentclass[12pt,openright,openany]{book}


\usepackage{ifxetex}
\ifxetex
  \usepackage[bookmarksnumbered]{hyperref}
\else
  \usepackage[unicode,bookmarksnumbered]{hyperref}
\fi

\usepackage[emptydoublepage]{NKThesis}   % 中文
%\usepackage[emptydoublepage,English]{NKThesis} % 英文

\usepackage{listings}
\usepackage{color}
\usepackage{xcolor}

\usepackage{amsmath}
\usepackage{bm}
\usepackage{amssymb}
\usepackage[ruled,vlined,algochapter]{algorithm2e}
\usepackage{subfigure}
\usepackage{multirow}
\usepackage{float}
\usepackage{booktabs}
\usepackage{fix-cm}

%   根据需要选择 biblatex 宏包选项.
%\usepackage[backend = biber, defernumbers = true,  sorting=none,  style = nkthesis]{biblatex}
\usepackage[backend = bibtex8, defernumbers = true,  sorting=none,  style = nkthesis]{biblatex}
\hypersetup{colorlinks=true,
            pdfborder=0 0 1,
            citecolor=black,
            linkcolor=black}

\raggedbottom

\addbibresource{nkthesis.bib}
\DeclareBibliographyCategory{cited}
\AtEveryCitekey{\addtocategory{cited}{\thefield{entrykey}}}

\includeonly{
abstract,
manual,
references,
acknowledgements,
resume
}
\newtheorem{Theorem}{\hskip 2em 定理}[chapter]
\newtheorem{Lemma}[Theorem]{\hskip 2em 引理}
\newtheorem{Corollary}[Theorem]{\hskip 2em 推论}
\newtheorem{Proposition}[Theorem]{\hskip 2em 命题}
\newtheorem{Definition}[Theorem]{\hskip 2em 定义}
\newtheorem{Example}[Theorem]{\hskip 2em 例}

\renewcommand\listfigurename{图清单}
\renewcommand\listtablename{表清单}
\renewcommand{\algorithmcfname}{算法}
\renewcommand\appendixname{ }

\hyphenpenalty=5000
\tolerance=1000

\newlength{\largNum}

\newlength{\tocRightMargin}
\setlength{\tocRightMargin}{2cm}

\newlength{\tocLeftMarginSecondLineFigure}
\setlength{\tocLeftMarginSecondLineFigure}{6.5em}

\makeatletter
\renewcommand*\l@figure[2]{%
  \settowidth{\largNum}{\hss #2}
  \ifnum \c@tocdepth >\m@ne%
    \addpenalty{-\@highpenalty}%
    \vskip 1.0em \@plus\p@%
    \setlength\@tempdima{3.4em}%
        \noindent%
    \begingroup
      \pretolerance=10000
      \parindent \z@ \rightskip \tocRightMargin%
      \parfillskip -\tocRightMargin%
     \leavevmode \normalsize%
     \advance\leftskip \tocLeftMarginSecondLineFigure%
      \hskip -\leftskip%
      {\figurename\mbox{\hspace{4pt}}#1}\nobreak%
       \leaders\hbox{$\m@th%
        \mkern \@dotsep mu\hbox{.}\mkern \@dotsep%
        mu$} \hfil\nobreak\hb@xt@%
                    \largNum{\hss #2}\par%
      \penalty\@highpenalty%
    \endgroup
  \fi}
\makeatother

\makeatletter
\renewcommand*\l@table[2]{%
  \settowidth{\largNum}{\hss #2}
  \ifnum \c@tocdepth >\m@ne%
    \addpenalty{-\@highpenalty}%
    \vskip 1.0em \@plus\p@%
    \setlength\@tempdima{3.4em}%
        \noindent%
    \begingroup
      \pretolerance=10000
      \parindent \z@ \rightskip \tocRightMargin%
      \parfillskip -\tocRightMargin%
     \leavevmode \normalsize%
     \advance\leftskip \tocLeftMarginSecondLineFigure%
      \hskip -\leftskip%
      {\tablename\mbox{\hspace{4pt}}#1}\nobreak%
       \leaders\hbox{$\m@th%
        \mkern \@dotsep mu\hbox{.}\mkern \@dotsep%
        mu$} \hfil\nobreak\hb@xt@%
                    \largNum{\hss #2}\par%
      \penalty\@highpenalty%
    \endgroup
  \fi}
\makeatother

\setcounter{secnumdepth}{3}
\begin{document}

%  设置基本信息
%  注意:  逗号`,'是项目分隔符. 如果某一项的值出现逗号, 应放在花括号内, 如 {,}
%
\NKTsetup{%
  论文题目(中文) =面向大规模网络的VoIP流量实时识别研究,
  副标题         = ,
  论文题目(英文) = A real-time identification system for VoIP traffic in large-scale networks,
  论文作者       = 王荣康,
  学号           = 2120160423,
  指导教师       = 张建忠  教授,
  申请学位       = 工学硕士,
  培养单位       = 计算机与控制工程学院,
  学科专业       = 计算机科学与技术,
  研究方向       = 网络与信息安全,
  中图分类号     = ,
  UDC            = ,
  学校代码       = 10055,
  密级           = 公开,
                   % 公开 | 限制 | 秘密 | 机密, 若为公开, 不填以下三项
  保密期限       = ,
  审批表编号     = ,
  批准日期       = ,
  论文完成时间   = 二〇一九年五月,
  答辩日期       = ,
  论文类别       = 学历硕士,
                   % 博士 | 学历硕士 | 硕士专业学位 | 高校教师 | 同等学力硕士
  院/系/所       = ,
  专业           = ,
  联系电话       = ,
  Email          = ,
  通讯地址(邮编) = ,
  备注           = ,
  是否批准为非公开论文 =,}

\include{abstract}
\tableofcontents
\include{manual}
%\include{appendices}
\include{references}
\listoffigures
%\clearpage
%{\phantomsection
\listoftables
\include{acknowledgements}
\include{resume}
\end{document}
